<!DOCTYPE html>
<html>
<head>
  <title>Loading Referral Code...</title>
  <meta charset="UTF-8">
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const urlParams = new URLSearchParams(window.location.search);
      const ref = urlParams.get("ref");

      if (ref) {
        // âœ… Save to localStorage (correct key)
        localStorage.setItem("referralCode", ref);
        alert("Referral code from URL: " + ref);

        // âœ… Send to Kodular (if inside WebView)
        if (window.AppInventor) {
          window.AppInventor.setWebViewString(ref);
        } else {
          alert("AppInventor object not available (testing outside app)");
        }
      } else {
        // No param â€” load from localStorage
        const storedRef = localStorage.getItem("referralCode");

        if (storedRef) {
          alert("Referral code from localStorage: " + storedRef);
          if (window.AppInventor) {
            window.AppInventor.setWebViewString(storedRef);
          } else {
            alert("AppInventor object not available (testing outside app)");
          }
        } else {
          alert("No referral code found.");
        }
      }
    });
  </script>
</head>
<body>
  <h3>ðŸ”„ Loading Referral Code...</h3>
</body>
</html>

